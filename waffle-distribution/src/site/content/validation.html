<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Validation</title>
  </head>
  <body>

    <h2>Validation</h2>

    <p>
      Waffle allows you to do validations in to two ways. The simplest being to make your ActionMethod responsible for
      validation. Simply add an <b>Errors</b> argument to your ActionMethod's argument list and Waffle will inject the
      current instance of Errors to your method. In the example below the ActionMethod "addToCart" third argument is
      an Errors object. The ActionMethod ensures that the quantity does not exceed 10, if so a new error message is
      created and add to the Errors instance.
    </p>

    <textarea class="java:nogutter:nocontrols" name="code">
      public class ShoppingCartController implements Serializable {
        private final MessageResources messageResources;
        private final Cart cart;

        public ShoppingCartController(MessageResources messageResources, Cart cart) {
          this.messageResources = messageResources;
          this.cart = cart;
        }

        // This ActionMethod handles its own validation
        public void addToCart(long itemId, int quantity, Errors errors) {
          if(quantity > 10) {
            String message = messageResources.getMessage("quantity.error");
            FieldError fieldError = new FieldError("quantity", quantity, message);
            errors.addFieldError(fieldError);
            return;
          }

          ...
        }
      }
    </textarea>

    <p>
      The second means of Validation allows for an external validation class by follows a few simple conventions.
      Suppose you have the following Controller registered under the name "foo":
    </p>

    <textarea class="java:nogutter:nocontrols" name="code">
      public class FooController {

        public String sayHello(String firstName, String lastName) {
          return "Hello, " + firstName + " " + lastName;
        }

        public void sayGoodbye() {
          return "Later!!";
        }
      }
    </textarea>

    <p>
      You can register any POJO you would like as a Validator. The only requirement is that it should be registered with
      the suffix <i>Validator</i>.  In other words the POJO registered under the name <i>"fooValidator"</i> would be the
      Validator for the controller registered under the name <i>"foo"</i>.  The Validator class will need to provide a
      seperate method for each ActionMethod requiring sepearte validation. These validate methods will need to be named
      identical to the ActionMethods they are providing validation for. The signature of the validate method is
      identical with the additional first argument being of type <b><a href="javadoc/core/org/codehaus/waffle/validation/ErrorsContext.html">
        org.codehaus.waffle.validation.ErrorsContext</a></b>. The following is an example of such a
      Validator:
    </p>

    <textarea class="java:nogutter:nocontrols" name="code">
      public class FooControllerValidator {

        // This is the validator for the FooController.sayHello(String, String) Actionmethod
        public void sayHello(ErrorsContext errors, String firstName, String lastName) {

          // validate and add error message to the errors if applicable

        }
      }
    </textarea>

    <p>Notice this Validator does not need to extend any custom Waffle classes or interfaces.</p>
  </body>

</html>
